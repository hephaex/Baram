# OpenSearch 3.x Configuration for nTimes Naver News Crawler
# Copyright (c) 2024 hephaex@gmail.com
# License: GPL v3

# ============================================================================
# Cluster Configuration
# ============================================================================
cluster.name: ntimes-cluster
node.name: ntimes-node-1

# Node roles (use cluster_manager instead of deprecated master)
node.roles:
  - cluster_manager
  - data
  - ingest

# ============================================================================
# Network Settings
# ============================================================================
network.host: 0.0.0.0
http.port: 9200
transport.port: 9300

# CORS for development (disable in production)
http.cors.enabled: true
http.cors.allow-origin: "*"
http.cors.allow-methods: OPTIONS, HEAD, GET, POST, PUT, DELETE
http.cors.allow-headers: X-Requested-With, X-Auth-Token, Content-Type, Content-Length, Authorization

# ============================================================================
# Discovery Configuration (Single-node for development)
# ============================================================================
discovery.type: single-node

# ============================================================================
# Memory Settings
# ============================================================================
bootstrap.memory_lock: true

# Circuit breaker settings to prevent OOM
indices.breaker.total.limit: 70%
indices.breaker.fielddata.limit: 40%
indices.breaker.request.limit: 40%

# ============================================================================
# Performance Tuning
# ============================================================================
thread_pool.write.queue_size: 1000
thread_pool.search.queue_size: 1000
indices.memory.index_buffer_size: 20%
indices.queries.cache.size: 10%

# ============================================================================
# Security Configuration (Disabled for development)
# ============================================================================
plugins.security.disabled: true

# ============================================================================
# k-NN Settings for Vector Search
# ============================================================================
# Note: k-NN plugin settings configured at index level in OpenSearch 3.x

# ============================================================================
# Advanced Settings
# ============================================================================
action.destructive_requires_name: true
action.auto_create_index: true

# ============================================================================
# Snapshot and Restore
# ============================================================================
path.repo: ["/usr/share/opensearch/backup"]
