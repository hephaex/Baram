# nTimes Naver News Crawler - Environment Variables
# Copyright (c) 2024 hephaex@gmail.com
# License: GPL v3
#
# IMPORTANT: Copy this file to .env and fill in the actual values
# DO NOT commit .env file to version control

# ============================================================================
# PostgreSQL Configuration
# ============================================================================
POSTGRES_DB=ntimes
POSTGRES_USER=ntimes
# SECURITY: Change this to a strong password
POSTGRES_PASSWORD=changeme_strong_password_here
POSTGRES_PORT=5432

# PostgreSQL connection string (used by Rust application)
DATABASE_URL=postgresql://ntimes:changeme_strong_password_here@localhost:5432/ntimes

# Connection pool settings
DB_POOL_MAX_SIZE=20
DB_POOL_MIN_IDLE=5
DB_POOL_TIMEOUT_SECONDS=30

# ============================================================================
# OpenSearch Configuration
# ============================================================================
# SECURITY: Change this to a strong password (min 8 chars, upper+lower+digit+special)
OPENSEARCH_INITIAL_ADMIN_PASSWORD=Admin123!ChangeMeNow

# OpenSearch ports
OPENSEARCH_PORT=9200
OPENSEARCH_PERF_PORT=9600

# Security settings
OPENSEARCH_SECURITY_DISABLED=false

# OpenSearch connection (used by Rust application)
OPENSEARCH_URL=http://localhost:9200
OPENSEARCH_USERNAME=admin
OPENSEARCH_PASSWORD=Admin123!ChangeMeNow

# Index settings
OPENSEARCH_INDEX_NAME=naver-news
OPENSEARCH_BULK_SIZE=100
OPENSEARCH_TIMEOUT_SECONDS=30

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_PORT=6379
REDIS_MAXMEMORY=256mb

# Redis connection (used by Rust application)
REDIS_URL=redis://localhost:6379
REDIS_DB=0

# Connection pool
REDIS_POOL_MAX_SIZE=10
REDIS_POOL_TIMEOUT_SECONDS=5

# ============================================================================
# Development Tools (Optional - only start with --profile development)
# ============================================================================
# OpenSearch Dashboards
OPENSEARCH_DASHBOARDS_PORT=5601

# pgAdmin
PGADMIN_PORT=5050
PGADMIN_EMAIL=admin@ntimes.local
PGADMIN_PASSWORD=admin

# ============================================================================
# Crawler Configuration
# ============================================================================
# Rate limiting (requests per second)
CRAWLER_REQUESTS_PER_SECOND=2
CRAWLER_MAX_RETRIES=3
CRAWLER_TIMEOUT_SECONDS=30

# User-Agent rotation
CRAWLER_USER_AGENT="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"

# Crawl limits
CRAWLER_MAX_ARTICLES_PER_RUN=1000
CRAWLER_MAX_COMMENTS_PER_ARTICLE=500

# Checkpoint directory
CRAWLER_CHECKPOINT_DIR=./checkpoints

# ============================================================================
# Storage Configuration
# ============================================================================
# Output directories
OUTPUT_DIR=./output
OUTPUT_RAW_DIR=./output/raw
OUTPUT_MARKDOWN_DIR=./output/markdown

# SQLite database (for local metadata)
SQLITE_DB_PATH=./ntimes.db

# ============================================================================
# Embedding Configuration
# ============================================================================
# Model settings
EMBEDDING_MODEL_NAME=intfloat/multilingual-e5-large
EMBEDDING_DIMENSION=1024
EMBEDDING_BATCH_SIZE=32

# Chunking settings
CHUNK_SIZE=512
CHUNK_OVERLAP=50

# Model cache directory
HF_HOME=./models
TRANSFORMERS_CACHE=./models/transformers

# ============================================================================
# LLM Configuration (for Ontology Extraction)
# ============================================================================
# Choose LLM provider: openai, anthropic, local, ollama
LLM_PROVIDER=ollama

# OpenAI settings
OPENAI_API_KEY=sk-your-api-key-here
OPENAI_MODEL=gpt-4-turbo-preview
OPENAI_MAX_TOKENS=2000

# Anthropic settings
ANTHROPIC_API_KEY=sk-ant-your-api-key-here
ANTHROPIC_MODEL=claude-3-sonnet-20240229
ANTHROPIC_MAX_TOKENS=2000

# Ollama settings (local)
OLLAMA_URL=http://localhost:11434
OLLAMA_MODEL=llama3:8b

# LLM retry settings
LLM_MAX_RETRIES=3
LLM_TIMEOUT_SECONDS=60

# ============================================================================
# Logging Configuration
# ============================================================================
# Log level: trace, debug, info, warn, error
RUST_LOG=info,ntimes=debug

# Log format: json, pretty
LOG_FORMAT=pretty

# Log output
LOG_FILE=./logs/ntimes.log

# ============================================================================
# Monitoring and Metrics
# ============================================================================
# Prometheus metrics endpoint
METRICS_ENABLED=false
METRICS_PORT=9090

# Health check endpoint
HEALTH_CHECK_PORT=8080

# ============================================================================
# Feature Flags
# ============================================================================
# Enable/disable specific features
FEATURE_COMMENTS_ENABLED=true
FEATURE_ONTOLOGY_ENABLED=true
FEATURE_VECTOR_SEARCH_ENABLED=true
FEATURE_DISTRIBUTED_CRAWLING=false

# ============================================================================
# Performance Tuning
# ============================================================================
# Tokio runtime threads (0 = auto-detect)
TOKIO_WORKER_THREADS=0

# Channel buffer sizes
CHANNEL_BUFFER_SIZE=1000

# Batch processing
BATCH_SIZE=100

# ============================================================================
# Security and Privacy
# ============================================================================
# Content sanitization
SANITIZE_HTML=true
REMOVE_SCRIPTS=true
REMOVE_STYLES=false

# Personal information masking
MASK_USER_IDS=true
MASK_EMAIL=true
MASK_PHONE=true

# ============================================================================
# Network Configuration
# ============================================================================
# Proxy settings (optional)
HTTP_PROXY=
HTTPS_PROXY=
NO_PROXY=localhost,127.0.0.1

# DNS settings
DNS_TIMEOUT_SECONDS=5

# Connection settings
TCP_KEEPALIVE_SECONDS=60
CONNECTION_TIMEOUT_SECONDS=10

# ============================================================================
# Error Handling
# ============================================================================
# Retry configuration
RETRY_INITIAL_INTERVAL_MS=1000
RETRY_MAX_INTERVAL_MS=60000
RETRY_MULTIPLIER=2.0
RETRY_RANDOMIZATION_FACTOR=0.1

# Circuit breaker
CIRCUIT_BREAKER_THRESHOLD=5
CIRCUIT_BREAKER_TIMEOUT_SECONDS=60

# ============================================================================
# Development Settings
# ============================================================================
# Development mode (enables debug features)
DEV_MODE=true

# Mock external services (for testing)
MOCK_NAVER_API=false

# Seed for reproducible testing
RANDOM_SEED=42

# ============================================================================
# Production Settings
# ============================================================================
# Sentry error tracking
SENTRY_DSN=

# Environment tag
ENVIRONMENT=development

# Application version
APP_VERSION=0.1.0

# ============================================================================
# Notes
# ============================================================================
# Production deployment checklist:
# 1. Change all default passwords
# 2. Enable SSL/TLS for all services
# 3. Set ENVIRONMENT=production
# 4. Configure proper backup strategies
# 5. Set up monitoring and alerting
# 6. Review and adjust rate limits
# 7. Enable audit logging
# 8. Configure firewalls and network policies
# 9. Set up log rotation
# 10. Review security group settings
